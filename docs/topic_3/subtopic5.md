---
sidebar_label: Основні види перетворення типів
---
# Основні види перетворення типів (звуження і розширення типів). Перевірка переповнення даних.

### Основні види перетворення типів

У мові C# типи даних можуть бути **неявно** або **явно** перетворені. Перетворення типів дозволяє змінювати один тип
даних на інший, що є важливим при виконанні арифметичних операцій, взаємодії з методами або класами, де потрібно
використовувати дані різних типів.

### **Розширення типів (Implicit Conversion)**

**Розширення типів** — це неявне перетворення, коли змінна одного типу даних може автоматично бути перетворена в інший
тип з більшим діапазоном або точністю без втрати інформації.

- Розширення типів зазвичай відбувається автоматично, якщо перетворення є **безпечним**.
- Наприклад, тип int можна безпечно перетворити у тип long, оскільки діапазон значень long більший.

**Приклад:**

```csharp
int number = 42;
long bigNumber = number; // Неявне перетворення int в long
```

### **Звуження типів (Explicit Conversion або Cast)**

**Звуження типів** — це явне перетворення, яке може призвести до втрати інформації або переповнення, тому потребує явної
вказівки (кастингу) програмістом.

- Для звуження типів використовується оператор **кастингу** — `()`

**Приклад:**

```csharp
double pi = 3.14159;
int intPi = (int)pi; // Явне перетворення double в int, втрата дробової частини
```

- Якщо кастинг не виконується явно, це може призвести до помилки компіляції.

### Перевірка переповнення даних

**Переповнення** відбувається тоді, коли значення змінної виходить за межі діапазону, який підтримується цим типом
даних. Переповнення може спричинити некоректну поведінку програми або згенерувати виняток.

### **Переповнення при звуженні типів**

При явному перетворенні з типу з більшою розрядністю в тип з меншою можливе **переповнення**, коли значення виходить за
межі допустимого діапазону цільового типу.

**Приклад:**

```csharp
int largeNumber = 300;
byte smallNumber = (byte)largeNumber; // Переповнення, оскільки byte не може зберігати значення більше 255
Console.WriteLine(smallNumber); // Виведе 44 (результат переповнення)
```

### **Контроль переповнення за допомогою ключових слів `checked` і `unchecked`**

Для того щоб перевірити чи відбувається переповнення під час виконання операцій, у C# можна використовувати блоки
`checked` та `unchecked`.

- **`checked`** викликає виняток `OverflowException`, якщо в межах блоку відбулося переповнення.
- **`unchecked`** дозволяє ігнорувати переповнення, навіть якщо воно мало місце.

**Приклад використання `checked`:**

```csharp
try
{
    int num = 100000;
    int result = checked(num * 100000); // Виняток через переповнення
}
catch (OverflowException e)
{
    Console.WriteLine("Переповнення: " + e.Message);
}
```

**Приклад використання `unchecked`:**

```csharp
int num = 100000;
int result = unchecked(num * 100000); // Переповнення, але не викликає виняток
Console.WriteLine(result); // Некоректне значення внаслідок переповнення
```

### **Переповнення в числових типах**

Числові типи даних, такі як int, long, byte, мають певний діапазон значень. Якщо значення виходить за межі цього
діапазону без використання `checked`, результатом може бути некоректне значення.

**Діапазони типів:**

- `int`: від -2,147,483,648 до 2,147,483,647
- `byte`: від 0 до 255
- `long`: від -9,223,372,036,854,775,808 до 9,223,372,036,854,775,807

### Висновок

Правильне використання перетворення типів — це важлива частина програмування на C#. Розширення типів є автоматичним і
безпечним, але звуження вимагає уважності та явного кастингу для уникнення переповнення. Використання ключових слів
`checked` і `unchecked` допомагає контролювати і відстежувати можливі переповнення, забезпечуючи надійність і
стабільність програмного коду.

---

### Питання для самоперевірки:

1. Яка різниця між неявним (implicit) і явним (explicit) перетворенням типів у C#?
2. Наведіть приклади розширення і звуження типів даних. Чому одне є безпечним, а інше може бути ризикованим?
3. Що відбувається при переповненні під час звуження типів? Як це може вплинути на роботу програми?
4. Для чого використовуються ключові слова `checked` і `unchecked` у C#? Які проблеми вони вирішують?
5. Які типи даних найбільше схильні до переповнення і чому?
